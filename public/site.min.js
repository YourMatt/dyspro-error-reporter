var app=angular.module("ErrorReporter",[]);$(document).ready(function(){utilities.formatJsonTables(),$(".popover-link").on("show.bs.popover",function(){$("#popover-shade").height($(document).height()-1).show()}).on("hidden.bs.popover",function(){$("#popover-shade").hide()})}),app.controller("DashboardController",["$scope",function(e){e.currentEnvironment="Dev",e.errorOccurrences=[],e.loadErrorOccurrences=dashboardPage.loadErrorOccurrences,e.changeEnvironmentTab=dashboardPage.changeEnvironmentTab,dashboardPage.init(e)}]);var dashboardPage={angularScope:null,init:function(e){dashboardPage.angularScope=e,dashboardPage.loadErrorOccurrences()},updateAngularValue:function(e){e();var t=dashboardPage.angularScope.$root.$$phase;"$apply"!==t&&"$digest"!==t&&dashboardPage.angularScope.$apply()},loadErrorOccurrences:function(){$.ajax("/api/errors/"+dashboardPage.angularScope.currentEnvironment+"/20").done(function(e){dashboardPage.updateAngularValue(function(){dashboardPage.angularScope.errorOccurrences=e})}).fail(function(e){notifications.errorFromServiceResponse(e)})},changeEnvironmentTab:function(e){dashboardPage.updateAngularValue(function(){dashboardPage.angularScope.currentEnvironment=e}),dashboardPage.loadErrorOccurrences()}},Error=function(){this.error_id=0,this.account_id=0,this.product="",this.stack_trace=""},ErrorOccurrence=function(){this.error=new Error,this.error_occurrence_id=0,this.environment="",this.message="",this.server="",this.user_name="",this.date=0,this.attachments=[]},ErrorAttachment=function(){this.file_name="",this.file_type=""},ErrorOccurrenceStats=function(){this.num_occurrences=0,this.date_first_occurrence=0,this.date_last_occurrence=0,this.all_on_single_day=!1};app.controller("ErrorHistoryController",["$scope",function(n){n.error_occurrences=[];var e="",t=$("environment","#error-occurrence-metadata").text();if(t){var o=$("errorid","#error-occurrence-metadata").text();e="/api/errors/"+t+"/"+o}else"undefined"!=typeof current_environment&&(e="/api/errors/"+current_environment);e&&(n.reloadErrorOccurrences=function(){$.ajax(e).done(function(e){if(e.error)console.log("Error: "+e.error);else{n.error_occurrences=[];for(var t=new ErrorOccurrenceStats,o=0;o<e.length;o++){var r=new ErrorOccurrence;r.error_occurrence_id=e[o].ErrorOccurrenceId,r.environment=e[o].Environment,r.message=e[o].Message,r.server=e[o].Server,r.user_name=e[o].UserName,r.date=moment(e[o].Date),r.error.error_id=e[o].ErrorId,r.error.account_id=e[o].AccountId,r.error.product=e[o].Product,r.error.stack_trace=e[o].StackTrace,n.error_occurrences.push(r),t.num_occurrences++,(!t.date_first_occurrence||moment(e[o].Date)<t.date_first_occurrence)&&(t.date_first_occurrence=moment(e[o].Date)),moment(e[o].Date)>t.date_last_occurrence&&(t.date_last_occurrence=moment(e[o].Date))}t.date_first_occurrence.format("MMDDYYYY")==t.date_last_occurrence.format("MMDDYYYY")&&(t.all_on_single_day=!0),n.error_occurrence_stats=t,n.$apply(),$("#RecentErrors").removeClass("hidden")}})},n.reloadErrorOccurrences())}]),$(document).ready(function(){}),app.controller("SettingsController",["$scope",function(e){e.user={},e.isUserFormSubmitDisabled=!0,e.monitors=[],e.products=[],e.environments=[],e.monitor={},e.monitorTestResults={},e.isMonitorFormSubmitDisabled=!0,e.saveUser=settingsPage.userForm.saveUser,e.saveMonitor=settingsPage.monitorForm.saveMonitor,e.resetForm=settingsPage.monitorForm.resetForm,e.selectMonitor=settingsPage.monitorForm.loadMonitor,e.selectProduct=settingsPage.monitorForm.selectExistingProduct,e.selectEnvironment=settingsPage.monitorForm.selectExistingEnvironment,e.$watch("monitor.intervalSeconds",settingsPage.monitorForm.handleIntervalSecondsChange),settingsPage.init(e)}]);var settingsPage={angularScope:null,init:function(e){settingsPage.angularScope=e,settingsPage.userForm.userId=$("userid","#account-metadata").text(),settingsPage.userForm.loadUser(),settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.loadProducts(),settingsPage.monitorForm.loadEnvironments(),settingsPage.monitorForm.initializeForm()},updateAngularValue:function(e){e();var t=settingsPage.angularScope.$root.$$phase;"$apply"!==t&&"$digest"!==t&&settingsPage.angularScope.$apply()},userForm:{userId:0,originalEmailAddress:"",formEnableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isUserFormSubmitDisabled=!1})},formDisableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isUserFormSubmitDisabled=!0})},initializeForm:function(){$("#setting-user-phone").mask("000-000-0000"),$("#setting-user-phone").val($("#setting-user-phone").masked()),settingsPage.userForm.formEnableSubmit()},getUserDataForSave:function(e){var t={name:e.name,email:e.email,phone:$("#setting-user-phone").cleanVal()},o=$("#setting-user-password-new").val();return o&&(t.password=o),t},loadUser:function(){$.ajax("/api/user/"+settingsPage.userForm.userId).done(function(e){settingsPage.userForm.originalEmailAddress=e.email,settingsPage.updateAngularValue(function(){settingsPage.angularScope.user=e}),settingsPage.userForm.initializeForm()}).fail(function(e){notifications.errorFromServiceResponse(e)})},saveUser:function(){settingsPage.userForm.isFormUserValidated()&&(settingsPage.userForm.formDisableSubmit(),$.ajax({type:"put",url:"/api/user/"+settingsPage.userForm.userId,data:settingsPage.userForm.getUserDataForSave(settingsPage.angularScope.user)}).done(function(e){$("#setting-user-password-current").val(""),$("#setting-user-password-new").val(""),settingsPage.userForm.originalEmailAddress=$("#setting-user-email").val(),notifications.success("Successfully saved your user information.")}).fail(function(e){notifications.errorFromServiceResponse(e)}).always(function(){settingsPage.userForm.formEnableSubmit()}))},isFormUserValidated:function(){var e="",t=$("#setting-user-phone").val();t.length&&12!==t.length&&(e="Invalid phone number."),$("#setting-user-phone")[0].setCustomValidity(e);var o=$("#setting-user-password-current").val();if(o?$.ajax({async:!1,type:"post",url:"/api/user/authenticate",data:{email:settingsPage.userForm.originalEmailAddress,password:o}}).done(function(){$("#setting-user-password-current")[0].setCustomValidity("")}).fail(function(){$("#setting-user-password-current")[0].setCustomValidity("Your original password is incorrect.")}):$("#setting-user-password-new").val(""),!1===$("#form-user")[0].checkValidity())return!1;var r=$("#setting-user-password-new").val();if(r){var n=$("#setting-user-password-new-confirm").val();if(!n)return $("#modal-password-confirm").on("shown.bs.modal",function(e){$("#setting-user-password-new-confirm").focus()}),$("#modal-password-confirm").modal(),!1;var i="";if(n!==r&&(i="Your password does not match what was entered."),$("#setting-user-password-new-confirm")[0].setCustomValidity(i),!1===$("#form-password-confirm")[0].checkValidity())return!1;$("#modal-password-confirm").modal("hide")}return!0}},monitorForm:{originalMonitorEndpointUri:"",formEnableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isMonitorFormSubmitDisabled=!1})},formDisableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isMonitorFormSubmitDisabled=!0})},getMonitorDataForSave:function(e){return{endpointUri:e.endpointUri,intervalSeconds:e.intervalSeconds,product:e.productName,environment:e.environmentName}},initializeForm:function(){settingsPage.monitorForm.formEnableSubmit(),settingsPage.monitorForm.resetForm(),$("input[name=setting-monitor-interval]").change(function(){var e=$(this).val();settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor.intervalSeconds=e})}),$("#button-delete").popover({content:$("#popover-content-delete-confirmation").html(),html:!0,placement:"bottom",template:'<div class="popover popover-confirmation" role="tooltip"><div class="arrow"></div><div class="popover-body"></div></div>'}).on("show.bs.popover",function(){$("#button-delete").prop("disabled",!0)}).on("hidden.bs.popover",function(){$("#button-delete").prop("disabled",!1)}),$(document).on("click","#button-delete-cancel",function(){$("#button-delete").popover("hide")}).on("click","#button-delete-confirm",function(){settingsPage.monitorForm.delete(),$("#button-delete").popover("hide")}),$("#link-about-metrics-on-page, #link-about-metrics-in-modal").popover({content:$("#popover-content-about-metrics").html(),html:!0,placement:"bottom",trigger:"focus"})},resetForm:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor={intervalSeconds:60}})},loadMonitors:function(){$.ajax("/api/monitors").done(function(e){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitors=e})}).fail(function(e){notifications.errorFromServiceResponse(e)})},loadMonitor:function(e){$.ajax("/api/monitor/"+e).done(function(e){settingsPage.monitorForm.originalMonitorEndpointUri=e.endpointUri,settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor=e}),utilities.scrollToTopOfPage()}).fail(function(e){notifications.errorFromServiceResponse(e)})},loadProducts:function(){$.ajax("/api/products").done(function(e){settingsPage.updateAngularValue(function(){settingsPage.angularScope.products=e})}).fail(function(e){notifications.errorFromServiceResponse(e)})},loadEnvironments:function(){$.ajax("/api/environments").done(function(e){settingsPage.updateAngularValue(function(){settingsPage.angularScope.environments=e})}).fail(function(e){notifications.errorFromServiceResponse(e)})},selectExistingProduct:function(e){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor.productName=e})},selectExistingEnvironment:function(e){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor.environmentName=e})},handleIntervalSecondsChange:function(e){e!=$("input[name=setting-monitor-interval]:checked").val()&&$("input[name=setting-monitor-interval][value="+e+"]").parent().click()},saveMonitor:function(){settingsPage.monitorForm.isFormValidated()&&(settingsPage.monitorForm.formDisableSubmit(),settingsPage.angularScope.monitor.endpointUri===settingsPage.monitorForm.originalMonitorEndpointUri?settingsPage.angularScope.monitor.monitorId?$.ajax({type:"put",url:"/api/monitor/"+settingsPage.angularScope.monitor.monitorId,data:settingsPage.monitorForm.getMonitorDataForSave(settingsPage.angularScope.monitor)}).done(function(e){settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.loadProducts(),settingsPage.monitorForm.loadEnvironments(),settingsPage.monitorForm.resetForm(),notifications.success("Successfully saved your monitor.")}).fail(function(e){notifications.errorFromServiceResponse(e)}).always(function(){$("#modal-endpoint-uri-test").modal("hide"),settingsPage.monitorForm.formEnableSubmit()}):$.ajax({type:"post",url:"/api/monitor",data:settingsPage.monitorForm.getMonitorDataForSave(settingsPage.angularScope.monitor)}).done(function(e){settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.loadProducts(),settingsPage.monitorForm.loadEnvironments(),settingsPage.monitorForm.resetForm(),notifications.success("Successfully saved your new monitor.")}).fail(function(e){notifications.errorFromServiceResponse(e)}).always(function(){$("#modal-endpoint-uri-test").modal("hide"),settingsPage.monitorForm.formEnableSubmit()}):$.ajax("/api/monitor/test/"+encodeURIComponent(settingsPage.angularScope.monitor.endpointUri)).done(function(e){if(!e.statusCode)return settingsPage.monitorForm.formEnableSubmit(),$("#setting-monitor-endpoint-uri")[0].setCustomValidity(e.requestErrorMessage),$("#setting-monitor-endpoint-uri")[0].reportValidity(),$("#form-monitor")[0].checkValidity(),void notifications.error("The Endpoint URI cannot be used. "+e.requestErrorMessage);e.responseParsed.responseTime=e.responseMilliseconds+"ms",e.statusText=settingsPage.monitorForm.evaluateHttpStatus(e.statusCode),settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitorTestResults=e}),settingsPage.monitorForm.originalMonitorEndpointUri=settingsPage.angularScope.monitor.endpointUri,$("#modal-endpoint-uri-test").modal()}).fail(function(e){notifications.errorFromServiceResponse(e)}).always(function(){settingsPage.monitorForm.formEnableSubmit()}))},delete:function(){var e=settingsPage.angularScope.monitor.monitorId;$.ajax({type:"delete",url:"/api/monitor/"+e}).done(function(e){settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.resetForm(),notifications.success("Successfully deleted the monitor.")}).fail(function(e){notifications.errorFromServiceResponse(e)})},isFormValidated:function(){return $("#setting-monitor-endpoint-uri")[0].setCustomValidity(""),!1!==$("#form-monitor")[0].checkValidity()},evaluateHttpStatus:function(e){return 200<=e&&e<300?"success":400<=e&&e<600?"error":"warning"}}};app.filter("firstLine",function(){return function(e){return e.split("\n")[0]}}),app.filter("formatDate",function(){return function(e,t){return t||(t="MM/DD [at] h:mm A"),moment(e).format(t)}});var notifications={success:function(e){toastr.success(e)},error:function(e){toastr.error(e)},errorFromServiceResponse:function(e){switch(e.status){case 0:return toastr.error("Error connecting to server. Please try again in a few moments.","Communication Error");case 401:return toastr.error("You were signed out after a period of inactivity. Please sign in and try again.<br/>Redirecting in <span id='notification-redirect-seconds'>5</span> seconds...","Authentication Error",{timeout:5e3,onShown:function(){var e=5;window.setInterval(function(){$("#notification-redirect-seconds").text(--e)},1e3)},onHidden:function(){document.location="/"}})}if(e.responseJSON&&e.responseJSON.error)return toastr.error(e.responseJSON.error);toastr.error("An unhandled error has occurred.",e.status+" error")}},utilities={scrollToTopOfPage:function(){$("html, body").stop().animate({scrollTop:0},300,"swing")},formatJsonTables:function(){$.each($(".table-json"),function(e,t){var o=$(t).text();try{for(var r=JSON.parse(o),n=[],i=0;i<r.length;i++)for(var a in r[i])n.indexOf(a)<0&&n.push(a);var s="<table class='table'>";s+="<tr>";for(i=0;i<n.length;i++)s+="<td>"+n[i]+"</td>";s+="</tr>";for(i=0;i<r.length;i++){s+="<tr>";for(var c=0;c<n.length;c++){void 0===(o=r[i][n[c]])&&(o=""),s+="<td>"+o+"</td>"}s+="</tr>"}s+="</table>",$(t).html(s)}catch(e){}})}},toptest=[];
//# sourceMappingURL=site.min.js.map