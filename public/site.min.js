var app=angular.module("ErrorReporter",[]);$(document).ready(function(){utilities.formatJsonTables(),$(".popover-link").on("show.bs.popover",function(){$("#popover-shade").height($(document).height()-1).show()}).on("hidden.bs.popover",function(){$("#popover-shade").hide()})}),app.controller("DashboardController",["$scope",function(t){localStorage.selectedEnvironment||(localStorage.selectedEnvironment="Dev"),t.currentEnvironment=localStorage.selectedEnvironment,t.errorOccurrences=[],t.totalErrors=0,t.changeEnvironmentTab=dashboardPage.changeEnvironmentTab,dashboardPage.init(t)}]);var dashboardPage={angularScope:null,init:function(t){dashboardPage.angularScope=t,dashboardPage.loadErrorOccurrences()},updateAngularValue:function(t){t();var e=dashboardPage.angularScope.$root.$$phase;"$apply"!==e&&"$digest"!==e&&dashboardPage.angularScope.$apply()},loadErrorOccurrences:function(t){$.ajax("/api/errors/"+dashboardPage.angularScope.currentEnvironment+(t?"/"+t:"")).done(function(t){dashboardPage.updateAngularValue(function(){dashboardPage.angularScope.errorOccurrences=t,dashboardPage.angularScope.totalErrors=t.length})}).fail(function(t){notifications.errorFromServiceResponse(t)})},changeEnvironmentTab:function(t){localStorage.selectedEnvironment=t,dashboardPage.updateAngularValue(function(){dashboardPage.angularScope.currentEnvironment=localStorage.selectedEnvironment}),dashboardPage.loadErrorOccurrences()}},Error=function(){this.error_id=0,this.account_id=0,this.product="",this.stack_trace=""},ErrorOccurrence=function(){this.error=new Error,this.error_occurrence_id=0,this.environment="",this.message="",this.server="",this.user_name="",this.date=0,this.attachments=[]},ErrorAttachment=function(){this.file_name="",this.file_type=""},ErrorOccurrenceStats=function(){this.num_occurrences=0,this.date_first_occurrence=0,this.date_last_occurrence=0,this.all_on_single_day=!1};app.controller("ErrorHistoryController",["$scope",function(o){o.error_occurrences=[];var t="",e=$("environment","#error-occurrence-metadata").text();if(e){var a=$("errorid","#error-occurrence-metadata").text();t="/api/errors/"+e+"/"+a}else"undefined"!=typeof current_environment&&(t="/api/errors/"+current_environment);t&&(o.reloadErrorOccurrences=function(){$.ajax(t).done(function(t){if(t.error)console.log("Error: "+t.error);else{o.error_occurrences=[];for(var e=new ErrorOccurrenceStats,a=0;a<t.length;a++){var r=new ErrorOccurrence;r.error_occurrence_id=t[a].ErrorOccurrenceId,r.environment=t[a].Environment,r.message=t[a].Message,r.server=t[a].Server,r.user_name=t[a].UserName,r.date=moment(t[a].Date),r.error.error_id=t[a].ErrorId,r.error.account_id=t[a].AccountId,r.error.product=t[a].Product,r.error.stack_trace=t[a].StackTrace,o.error_occurrences.push(r),e.num_occurrences++,(!e.date_first_occurrence||moment(t[a].Date)<e.date_first_occurrence)&&(e.date_first_occurrence=moment(t[a].Date)),moment(t[a].Date)>e.date_last_occurrence&&(e.date_last_occurrence=moment(t[a].Date))}e.date_first_occurrence.format("MMDDYYYY")==e.date_last_occurrence.format("MMDDYYYY")&&(e.all_on_single_day=!0),o.error_occurrence_stats=e,o.$apply(),$("#RecentErrors").removeClass("hidden")}})},o.reloadErrorOccurrences())}]),$(document).ready(function(){}),app.controller("SettingsController",["$scope",function(t){t.user={},t.isUserFormSubmitDisabled=!0,t.monitors=[],t.products=[],t.environments=[],t.monitor={},t.monitorTestResults={},t.isMonitorFormSubmitDisabled=!0,t.saveUser=settingsPage.userForm.saveUser,t.saveMonitor=settingsPage.monitorForm.saveMonitor,t.resetForm=settingsPage.monitorForm.resetForm,t.selectMonitor=settingsPage.monitorForm.loadMonitor,t.selectProduct=settingsPage.monitorForm.selectExistingProduct,t.selectEnvironment=settingsPage.monitorForm.selectExistingEnvironment,t.$watch("monitor.intervalSeconds",settingsPage.monitorForm.handleIntervalSecondsChange),settingsPage.init(t)}]);var settingsPage={angularScope:null,init:function(t){settingsPage.angularScope=t,settingsPage.userForm.userId=$("userid","#account-metadata").text(),settingsPage.userForm.loadUser(),settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.loadProducts(),settingsPage.monitorForm.loadEnvironments(),settingsPage.monitorForm.initializeForm()},updateAngularValue:function(t){t();var e=settingsPage.angularScope.$root.$$phase;"$apply"!==e&&"$digest"!==e&&settingsPage.angularScope.$apply()},userForm:{userId:0,originalEmailAddress:"",formEnableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isUserFormSubmitDisabled=!1})},formDisableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isUserFormSubmitDisabled=!0})},initializeForm:function(){$("#setting-user-phone").mask("000-000-0000"),$("#setting-user-phone").val($("#setting-user-phone").masked()),settingsPage.userForm.formEnableSubmit()},getUserDataForSave:function(t){var e={name:t.name,email:t.email,phone:$("#setting-user-phone").cleanVal()},a=$("#setting-user-password-new").val();return a&&(e.password=a),e},loadUser:function(){$.ajax("/api/user/"+settingsPage.userForm.userId).done(function(t){settingsPage.userForm.originalEmailAddress=t.email,settingsPage.updateAngularValue(function(){settingsPage.angularScope.user=t}),settingsPage.userForm.initializeForm()}).fail(function(t){notifications.errorFromServiceResponse(t)})},saveUser:function(){settingsPage.userForm.isFormUserValidated()&&(settingsPage.userForm.formDisableSubmit(),$.ajax({type:"put",url:"/api/user/"+settingsPage.userForm.userId,data:settingsPage.userForm.getUserDataForSave(settingsPage.angularScope.user)}).done(function(t){$("#setting-user-password-current").val(""),$("#setting-user-password-new").val(""),settingsPage.userForm.originalEmailAddress=$("#setting-user-email").val(),notifications.success("Successfully saved your user information.")}).fail(function(t){notifications.errorFromServiceResponse(t)}).always(function(){settingsPage.userForm.formEnableSubmit()}))},isFormUserValidated:function(){var t="",e=$("#setting-user-phone").val();e.length&&12!==e.length&&(t="Invalid phone number."),$("#setting-user-phone")[0].setCustomValidity(t);var a=$("#setting-user-password-current").val();if(a?$.ajax({async:!1,type:"post",url:"/api/user/authenticate",data:{email:settingsPage.userForm.originalEmailAddress,password:a}}).done(function(){$("#setting-user-password-current")[0].setCustomValidity("")}).fail(function(){$("#setting-user-password-current")[0].setCustomValidity("Your original password is incorrect.")}):$("#setting-user-password-new").val(""),!1===$("#form-user")[0].checkValidity())return!1;var r=$("#setting-user-password-new").val();if(r){var o=$("#setting-user-password-new-confirm").val();if(!o)return $("#modal-password-confirm").on("shown.bs.modal",function(t){$("#setting-user-password-new-confirm").focus()}),$("#modal-password-confirm").modal(),!1;var i="";if(o!==r&&(i="Your password does not match what was entered."),$("#setting-user-password-new-confirm")[0].setCustomValidity(i),!1===$("#form-password-confirm")[0].checkValidity())return!1;$("#modal-password-confirm").modal("hide")}return!0}},monitorForm:{originalMonitorEndpointUri:"",formEnableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isMonitorFormSubmitDisabled=!1})},formDisableSubmit:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.isMonitorFormSubmitDisabled=!0})},getMonitorDataForSave:function(t){return{endpointUri:t.endpointUri,intervalSeconds:t.intervalSeconds,product:t.productName,environment:t.environmentName}},initializeForm:function(){settingsPage.monitorForm.formEnableSubmit(),settingsPage.monitorForm.resetForm(),$("input[name=setting-monitor-interval]").change(function(){var t=$(this).val();settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor.intervalSeconds=t})}),$("#button-delete").popover({content:$("#popover-content-delete-confirmation").html(),html:!0,placement:"bottom",template:'<div class="popover popover-confirmation" role="tooltip"><div class="arrow"></div><div class="popover-body"></div></div>'}).on("show.bs.popover",function(){$("#button-delete").prop("disabled",!0)}).on("hidden.bs.popover",function(){$("#button-delete").prop("disabled",!1)}),$(document).on("click","#button-delete-cancel",function(){$("#button-delete").popover("hide")}).on("click","#button-delete-confirm",function(){settingsPage.monitorForm.delete(),$("#button-delete").popover("hide")}),$("#link-about-metrics-on-page, #link-about-metrics-in-modal").popover({content:$("#popover-content-about-metrics").html(),html:!0,placement:"bottom",trigger:"focus"})},resetForm:function(){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor={intervalSeconds:60}})},loadMonitors:function(){$.ajax("/api/monitors").done(function(t){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitors=t})}).fail(function(t){notifications.errorFromServiceResponse(t)})},loadMonitor:function(t){$.ajax("/api/monitor/"+t).done(function(t){settingsPage.monitorForm.originalMonitorEndpointUri=t.endpointUri,settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor=t}),utilities.scrollToTopOfPage()}).fail(function(t){notifications.errorFromServiceResponse(t)})},loadProducts:function(){$.ajax("/api/products").done(function(t){settingsPage.updateAngularValue(function(){settingsPage.angularScope.products=t})}).fail(function(t){notifications.errorFromServiceResponse(t)})},loadEnvironments:function(){$.ajax("/api/environments").done(function(t){settingsPage.updateAngularValue(function(){settingsPage.angularScope.environments=t})}).fail(function(t){notifications.errorFromServiceResponse(t)})},selectExistingProduct:function(t){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor.productName=t})},selectExistingEnvironment:function(t){settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitor.environmentName=t})},handleIntervalSecondsChange:function(t){t!=$("input[name=setting-monitor-interval]:checked").val()&&$("input[name=setting-monitor-interval][value="+t+"]").parent().click()},saveMonitor:function(){settingsPage.monitorForm.isFormValidated()&&(settingsPage.monitorForm.formDisableSubmit(),settingsPage.angularScope.monitor.endpointUri===settingsPage.monitorForm.originalMonitorEndpointUri?settingsPage.angularScope.monitor.monitorId?$.ajax({type:"put",url:"/api/monitor/"+settingsPage.angularScope.monitor.monitorId,data:settingsPage.monitorForm.getMonitorDataForSave(settingsPage.angularScope.monitor)}).done(function(t){settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.loadProducts(),settingsPage.monitorForm.loadEnvironments(),settingsPage.monitorForm.resetForm(),notifications.success("Successfully saved your monitor.")}).fail(function(t){notifications.errorFromServiceResponse(t)}).always(function(){$("#modal-endpoint-uri-test").modal("hide"),settingsPage.monitorForm.formEnableSubmit()}):$.ajax({type:"post",url:"/api/monitor",data:settingsPage.monitorForm.getMonitorDataForSave(settingsPage.angularScope.monitor)}).done(function(t){settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.loadProducts(),settingsPage.monitorForm.loadEnvironments(),settingsPage.monitorForm.resetForm(),notifications.success("Successfully saved your new monitor.")}).fail(function(t){notifications.errorFromServiceResponse(t)}).always(function(){$("#modal-endpoint-uri-test").modal("hide"),settingsPage.monitorForm.formEnableSubmit()}):$.ajax("/api/monitor/test/"+encodeURIComponent(settingsPage.angularScope.monitor.endpointUri)).done(function(t){if(!t.statusCode)return settingsPage.monitorForm.formEnableSubmit(),$("#setting-monitor-endpoint-uri")[0].setCustomValidity(t.requestErrorMessage),$("#setting-monitor-endpoint-uri")[0].reportValidity(),$("#form-monitor")[0].checkValidity(),void notifications.error("The Endpoint URI cannot be used. "+t.requestErrorMessage);t.responseParsed.responseTime=t.responseMilliseconds+"ms",t.statusText=settingsPage.monitorForm.evaluateHttpStatus(t.statusCode),settingsPage.updateAngularValue(function(){settingsPage.angularScope.monitorTestResults=t}),settingsPage.monitorForm.originalMonitorEndpointUri=settingsPage.angularScope.monitor.endpointUri,$("#modal-endpoint-uri-test").modal()}).fail(function(t){notifications.errorFromServiceResponse(t)}).always(function(){settingsPage.monitorForm.formEnableSubmit()}))},delete:function(){var t=settingsPage.angularScope.monitor.monitorId;$.ajax({type:"delete",url:"/api/monitor/"+t}).done(function(t){settingsPage.monitorForm.loadMonitors(),settingsPage.monitorForm.resetForm(),notifications.success("Successfully deleted the monitor.")}).fail(function(t){notifications.errorFromServiceResponse(t)})},isFormValidated:function(){return $("#setting-monitor-endpoint-uri")[0].setCustomValidity(""),!1!==$("#form-monitor")[0].checkValidity()},evaluateHttpStatus:function(t){return 200<=t&&t<300?"success":400<=t&&t<600?"error":"warning"}}};app.filter("firstLine",function(){return function(t){return t.split("\n")[0]}}),app.filter("formatDate",function(){return function(t,e){return e||(e="MM/DD [at] h:mm A"),moment(t).format(e)}}),$(document).ready(function(){dysproGraph.BuildGraph(),$("#GraphOptionSelector li").tooltip()}),$(window).resize(function(){dysproGraph.BuildGraph()});var dysproGraph={graphType:"",gameData:{scores:[],levels:[],times:[],dates:[],stats:{highScore:0,lowScore:0,averageScore:0,highLevel:0},totalScores:0,highScoreIndex:0,lastSelectedIndex:0},lastGraphType:"",lastBuildWidth:0,canvas:null,dims:{width:0,height:0,graphPositionTop:0,graphPositionBottom:0,graphPositionLeft:0,graphPositionRight:0,graphWidth:0,graphHeight:0,graphScoreSpacing:0,graphLevelSpacing:0,graphMarginTop:30,graphMarginBottom:50,graphMarginMinLeft:50,labelMarginTop:5,labelMarginLeft:10,labelMarginBottom:14,graphPadding:5},colors:{axisLine:"#888888",graphLine:"#333333",averageLine:"#f26522",levelWithoutTime:"#e6e6e6",alert:["#ed2024","#e85c25","#e98423","#e9b235","#e4c634","#d5d026","#cece25","#aed147","#93c847","#69bd45"]},sizes:{axisLine:2,graphLine:3,averageLine:1,bestLine:1,barGraphWidthPercent:80,labelSmall:14,labelMedium:20,labelLarge:26,animationTime:250},elements:{scoreIndicatorLine:null,scoreIndicatorScore:null,scoreIndicatorDate:null,graphLine:null},BuildGraph:function(){this.InitializeGraph()&&(this.canvas.clear(),this.DrawGraph())},InitializeGraph:function(){return!!$("#ProgressGraph").length&&(this.canvas||(this.canvas=Snap("#ProgressGraph")),this.graphType=$("#ProgressGraph").attr("graphtype"),this.dims.width=$("#ProgressGraph").width(),this.dims.height=$("#ProgressGraph").height(),(this.dims.width!=this.lastBuildWidth||this.graphType!=this.lastGraphType)&&(this.lastBuildWidth=this.dims.width,this.lastGraphType=this.graphType,this.gameData.scores=this.SplitDataElementsAsInt($("scores",$("#ProgressGraphData")).text()),this.gameData.dates=this.SplitDataElementsAsInt($("dates",$("#ProgressGraphData")).text()),this.gameData.totalScores=this.gameData.scores.length,this.LoadGameStats(),this.LoadGraphPositions(),!0))},LoadGraphPositions:function(){this.dims.graphPositionTop=this.dims.graphMarginTop,this.dims.graphPositionBottom=this.dims.height-this.dims.graphMarginBottom,this.dims.graphHeight=this.dims.graphPositionBottom-this.dims.graphPositionTop;var t=this.canvas.text(0,100,this.gameData.stats.averageScore.toLocaleString());t.attr({fontSize:this.sizes.labelMedium+"px"});var e=parseInt(t.getBBox().width);this.dims.graphPositionLeft=e+2*this.dims.labelMarginLeft,this.dims.graphPositionLeft<this.dims.graphMarginMinLeft&&(this.dims.graphPositionLeft=this.dims.graphMarginMinLeft),this.dims.graphPositionRight=this.dims.width-this.dims.graphPositionLeft,this.dims.graphWidth=this.dims.graphPositionRight-this.dims.graphPositionLeft},LoadGameStats:function(){var t=0,e=0,a=0,r=0,o=this.gameData.scores.length;if(o){t=this.gameData.scores[0],e=this.gameData.scores[0];for(var i=0;i<o;i++)this.gameData.scores[i]>t&&(t=this.gameData.scores[i]),this.gameData.scores[i]<e&&(e=this.gameData.scores[i]),this.gameData.levels[i]>r&&(r=this.gameData.levels[i]),a+=this.gameData.scores[i]}this.gameData.stats.highScore=t,this.gameData.stats.lowScore=e,this.gameData.stats.averageScore=Math.round(a/o),this.gameData.stats.highLevel=r},DrawGraph:function(){"line"==this.graphType?this.DrawScoreGraph():"levels"==this.graphType&&this.DrawLevelGraph()},DrawScoreGraph:function(){this.DrawAxisLines(),this.DrawBottomDateLabels(),this.DrawLeftScoreLabels();var t=this.dims.graphPositionTop+this.dims.graphPadding,e=this.dims.graphPositionBottom-this.dims.graphPadding,a=e-t,r="",o=this.gameData.scores.length,i=o-1,s=0,n=0,c=0,m=0,h=0,g=0,l=0,d=0,p=0;if(this.dims.graphScoreSpacing=this.dims.graphWidth/i,1==this.gameData.totalScores)r="M{0} {1}L{2} {3}".format(this.dims.graphPositionLeft,this.dims.graphPositionTop+this.dims.graphHeight/2,this.dims.graphPositionRight,this.dims.graphPositionTop+this.dims.graphHeight/2);else for(var u=0;u<o;u++)s=parseInt(this.dims.graphPositionLeft+u*this.dims.graphScoreSpacing),c=parseInt(e-a*(this.gameData.scores[u]-this.gameData.stats.lowScore)/(this.gameData.stats.highScore-this.gameData.stats.lowScore)),u?(n=parseInt(this.dims.graphPositionLeft+(u-.5)*this.dims.graphScoreSpacing),g=c,(p=0)<u&&u<o-1&&(this.gameData.scores[u-1]<this.gameData.scores[u]&&this.gameData.scores[u]<this.gameData.scores[u+1]?p=-1:this.gameData.scores[u-1]>this.gameData.scores[u]&&this.gameData.scores[u]>this.gameData.scores[u+1]&&(p=1),p&&(h=parseInt(e-a*(this.gameData.scores[u+1]-this.gameData.stats.lowScore)/(this.gameData.stats.highScore-this.gameData.stats.lowScore)),g=c-p*(d=Math.min(p*(c-m),p*(h-c))))),l||(l=m),r+="C{0} {1} {2} {3} {4} {5}".format(n,l,n,g,s,c)):r+="M{0} {1}".format(s,c),this.gameData.scores[u]==this.gameData.stats.highScore&&(this.gameData.highScoreIndex=u,this.gameData.lastSelectedIndex=u,this.DrawScoreIndicator(s,u)),this.canvas.rect(u?n:this.dims.graphPositionLeft,this.dims.graphPositionTop,this.dims.graphWidth/i,this.dims.graphHeight).attr({fill:"rgba(255,255,255,0)",scoreIndex:u,linePositionLeft:s}).mouseover(dysproGraphEventHandlers.MoveScoreIndicator),m=c,l=p?c+p*d:0;var f={stroke:this.colors.graphLine,strokeWidth:this.sizes.graphLine,fill:"none"};this.elements.graphLine=this.canvas.path(r).attr(f)},DrawLevelGraph:function(){this.DrawAxisLines(),this.DrawBottomDateLabels(),this.DrawLeftLevelLabels();var t=this.gameData.levels.length;this.dims.graphLevelSpacing=this.dims.graphWidth/t;for(var e=0,a=0,r=this.sizes.barGraphWidthPercent/100,o=0,i=0,s=0;s<t;s++)e=parseInt(this.dims.graphPositionLeft+s*this.dims.graphLevelSpacing),this.gameData.levels[s]&&(i=this.dims.graphWidth/t,i-=2*(o=(1-r)/2*i),a=parseInt(this.dims.graphPositionBottom-this.dims.graphHeight*this.gameData.levels[s]/this.gameData.stats.highLevel),this.canvas.rect(e+o,a,i,this.dims.graphPositionBottom-a-this.sizes.axisLine/2).attr({fill:this.colors.levelWithoutTime,stroke:"none"}))},DrawAxisLines:function(){var t={stroke:this.colors.axisLine,strokeWidth:this.sizes.axisLine};this.canvas.path("M{0} {1}L{2} {3}".format(this.dims.graphPositionLeft,this.dims.graphPositionBottom,this.dims.graphPositionRight,this.dims.graphPositionBottom)).attr(t),this.canvas.path("M{0} {1}L{2} {3}".format(this.dims.graphPositionLeft,this.dims.graphPositionTop,this.dims.graphPositionLeft,this.dims.graphPositionBottom)).attr(t)},DrawLeftScoreLabels:function(){var t={fontSize:this.sizes.labelSmall,fill:this.colors.averageLine},e={fontSize:this.sizes.labelMedium,fill:this.colors.averageLine},a={stroke:this.colors.averageLine,strokeWidth:this.sizes.averageLine},r=.5;this.gameData.stats.highScore!=this.gameData.stats.lowScore&&(r=(this.gameData.stats.averageScore-this.gameData.stats.lowScore)/(this.gameData.stats.highScore-this.gameData.stats.lowScore));var o=this.dims.graphPositionBottom-this.dims.graphHeight*r;this.canvas.path("M{0} {1}L{2} {3}".format(this.dims.graphPositionLeft,o,this.dims.graphPositionRight,o)).attr(a),this.canvas.text(this.dims.labelMarginLeft,o+this.sizes.labelMedium/2,this.gameData.stats.averageScore.toLocaleString()).attr(e);var i=this.canvas.text(0,0,"avg").attr(t);i.transform("t{0},{1}".format(this.dims.graphPositionLeft/2-i.getBBox().width/2,o-this.sizes.labelMedium/2))},DrawLeftLevelLabels:function(){var t=1;50<=this.gameData.stats.highLevel?t=10:20<=this.gameData.stats.highLevel?t=5:8<=this.gameData.stats.highLevel&&(t=2);for(var e,a=0,r=0,o=0,i=t;i<=this.gameData.stats.highLevel;i+=t)a=i/this.gameData.stats.highLevel,r=9-Math.floor(9.99*a),o=this.dims.graphPositionBottom-this.dims.graphHeight*a,this.canvas.path("M{0} {1}L{2} {3}".format(this.dims.graphPositionLeft,o,this.dims.graphPositionRight,o)).attr({stroke:this.colors.alert[r],strokeWidth:1}),(e=this.canvas.text(0,0,i).attr({fontSize:this.sizes.labelSmall,fill:this.colors.alert[r]})).transform("t{0} {1}".format(this.dims.graphPositionLeft-(e.getBBox().width+this.dims.labelMarginLeft),o+this.sizes.labelSmall/2-2))},DrawBottomDateLabels:function(){var t=this.GetFormattedStartDate(new Date(this.gameData.dates[0])),e=this.GetFormattedEndDate(new Date(this.gameData.dates[this.gameData.dates.length-1])),a={fontSize:this.sizes.labelMedium+"px",fill:this.colors.axisLine},r=this.canvas.text(0,0,t).attr(a),o=this.canvas.text(0,0,e).attr(a),i=this.dims.graphPositionLeft-r.getBBox().width/2,s=this.dims.graphPositionRight-o.getBBox().width/2,n=this.dims.graphPositionBottom+this.dims.labelMarginBottom+this.sizes.labelMedium;r.transform("t{0},{1}".format(i,n)),o.transform("t{0},{1}".format(s,n))},DrawScoreIndicator:function(t,e){var a={fontSize:this.sizes.labelMedium+"px",fill:this.colors.alert[0]},r={fontSize:this.sizes.labelSmall+"px",fill:this.colors.alert[0]},o={stroke:this.colors.alert[0],strokeWidth:this.sizes.bestLine,fill:"none",strokeDasharray:"5,5"};this.elements.scoreIndicatorLine=this.canvas.path("M{0} {1}L{2} {3}".format(t,this.dims.graphPositionTop,t,this.dims.graphPositionBottom)).attr(o),this.elements.scoreIndicatorScore=this.canvas.text(0,0,this.gameData.stats.highScore.toLocaleString()).attr(a),this.elements.scoreIndicatorScore.transform("t{0},{1}".format(t-this.elements.scoreIndicatorScore.getBBox().width/2,this.dims.graphPositionTop-this.dims.labelMarginTop));var i=new Date(this.gameData.dates[e]);this.elements.scoreIndicatorDate=this.canvas.text(0,0,moment.unix(i).format("MM/DD/YYYY")).attr(r),this.elements.scoreIndicatorDate.transform("t{0},{1}".format(t-this.elements.scoreIndicatorDate.getBBox().width/2,this.dims.graphPositionBottom+this.sizes.labelSmall))},GetFormattedStartDate:function(t){return moment.unix(t).format("MMMM YYYY")},GetFormattedEndDate:function(t){var e=new Date(Date.parse(moment().format("MM/DD/YYYY"))),a=new Date(e-864e5),r=new Date(e-864e5*e.getDay()),o=new Date(e-864e5*(e.getDay()+7)),i=new Date(Date.parse(moment().format("MM/01/YYYY"))),s=new Date(Date.parse(moment().subtract(1,"months").format("MM/01/YYYY")));return e<t?"Today":a<t?"Yesterday":r<t?"This Week":o<t?"Last Week":i<t?"This Month":s<t?"Last Month":moment.unix(t).format("MMMM YYYY")},GetFormattedDateRange:function(t,e){var a=e-t,r=Math.round(a/604800);return r<=7?"{0} week{1}".format(r,1!=r?"s":""):(r=Math.round(a/2592e3))<=23?"{0} months".format(r):(r=Math.round(a/31536e3),"{0} years".format(r))},SplitDataElementsAsInt:function(t){for(var e=t.split(","),a=0;a<e.length;a++)e[a]=parseInt(e[a]);return e}},dysproGraphEventHandlers={MoveScoreIndicator:function(t){var e,a=t.target.attributes.scoreIndex.value,r=t.target.attributes.linePositionLeft.value,o=.1<Math.abs(dysproGraph.gameData.lastSelectedIndex-a)/dysproGraph.gameData.totalScores,i=dysproGraph.gameData.scores[a]-dysproGraph.gameData.stats.lowScore,s=dysproGraph.gameData.stats.highScore-dysproGraph.gameData.stats.lowScore+1,n=Math.ceil(10*(1-i/s))-1;e="t{0},{1}".format((a-dysproGraph.gameData.highScoreIndex)*dysproGraph.dims.graphScoreSpacing,0),o?dysproGraph.elements.scoreIndicatorLine.animate({transform:e},dysproGraph.sizes.animationTime):dysproGraph.elements.scoreIndicatorLine.transform(e);var c=new Date(dysproGraph.gameData.dates[a]);dysproGraph.elements.scoreIndicatorDate.attr({text:moment.unix(c).format("MM/DD/YYYY")}),e="t{0},{1}".format(r-dysproGraph.elements.scoreIndicatorDate.getBBox().width/2,dysproGraph.dims.graphPositionBottom+dysproGraph.sizes.labelSmall),o?dysproGraph.elements.scoreIndicatorDate.animate({transform:e},dysproGraph.sizes.animationTime):dysproGraph.elements.scoreIndicatorDate.transform(e),dysproGraph.elements.scoreIndicatorScore.attr({text:dysproGraph.gameData.scores[a].toLocaleString()}),e="t{0},{1}".format(r-dysproGraph.elements.scoreIndicatorScore.getBBox().width/2,dysproGraph.dims.graphPositionTop-dysproGraph.dims.labelMarginTop),o?dysproGraph.elements.scoreIndicatorScore.animate({transform:e},dysproGraph.sizes.animationTime):dysproGraph.elements.scoreIndicatorScore.transform(e),dysproGraph.elements.scoreIndicatorLine.animate({stroke:dysproGraph.colors.alert[n]},dysproGraph.sizes.animationTime),dysproGraph.elements.scoreIndicatorDate.animate({fill:dysproGraph.colors.alert[n]},dysproGraph.sizes.animationTime),dysproGraph.elements.scoreIndicatorScore.animate({fill:dysproGraph.colors.alert[n]},dysproGraph.sizes.animationTime),dysproGraph.gameData.lastSelectedIndex=a}},notifications={success:function(t){toastr.success(t)},error:function(t){toastr.error(t)},errorFromServiceResponse:function(t){switch(t.status){case 0:return toastr.error("Error connecting to server. Please try again in a few moments.","Communication Error");case 401:return toastr.error("You were signed out after a period of inactivity. Please sign in and try again.<br/>Redirecting in <span id='notification-redirect-seconds'>5</span> seconds...","Authentication Error",{timeout:5e3,onShown:function(){var t=5;window.setInterval(function(){$("#notification-redirect-seconds").text(--t)},1e3)},onHidden:function(){document.location="/"}})}if(t.responseJSON&&t.responseJSON.error)return toastr.error(t.responseJSON.error);toastr.error("An unhandled error has occurred.",t.status+" error")}};String.prototype.format=function(){var t=this;for(var e in arguments)t=t.replace("{"+e+"}",arguments[e]);return t};var utilities={scrollToTopOfPage:function(){$("html, body").stop().animate({scrollTop:0},300,"swing")},formatJsonTables:function(){$.each($(".table-json"),function(t,e){var a=$(e).text();try{for(var r=JSON.parse(a),o=[],i=0;i<r.length;i++)for(var s in r[i])o.indexOf(s)<0&&o.push(s);var n="<table class='table'>";n+="<tr>";for(i=0;i<o.length;i++)n+="<td>"+o[i]+"</td>";n+="</tr>";for(i=0;i<r.length;i++){n+="<tr>";for(var c=0;c<o.length;c++){void 0===(a=r[i][o[c]])&&(a=""),n+="<td>"+a+"</td>"}n+="</tr>"}n+="</table>",$(e).html(n)}catch(t){}})}};
//# sourceMappingURL=site.min.js.map